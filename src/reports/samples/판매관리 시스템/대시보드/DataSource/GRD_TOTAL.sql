WITH PFM AS (
	SELECT SUM(NET_AMOUNT) AS TOT_AMT
		 , COUNT(DISTINCT CUST_ID) AS TOT_CUST
	  FROM SM_SALES_PERFORMANCE
	 WHERE TO_CHAR(SALES_DATE,'YYYY') = :VS_YEAR
),
PLN AS (
	SELECT SUM(TARGET_AMT) AS TARGET_AMT
	  FROM SM_SALES_PLAN
	WHERE PLAN_YEAR = :VS_YEAR
),
PROD AS (
	SELECT COUNT(*) AS SALES_PROD
	  FROM SM_PRODUCT
	 WHERE SALE_YN = 'Y'
)
SELECT PFM.TOT_AMT AS TOT_AMT
	 , PFM.TOT_AMT/PLN.TARGET_AMT AS RATE
	 , TOT_CUST || '개사' AS TOT_CUST
	 , SALES_PROD || '종' AS SALES_PROD
  FROM PFM
 CROSS JOIN PLN
 CROSS JOIN PROD
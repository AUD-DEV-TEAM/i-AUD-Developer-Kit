SELECT 'PLAN-' || SUBSTR(:VS_YM,1,4) || '-'
       || RIGHT('000' 
            	|| (COALESCE(MAX(CAST(SUBSTRING(PLAN_ID, 11, 3) AS INTEGER)),0) + 1)::TEXT
          		, 3) AS PLAN_ID
FROM SM_SALES_PLAN
WHERE SUBSTRING(PLAN_ID, 6, 4) = SUBSTR(:VS_YM,1,4)
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì—…ê´€ë¦¬ ì‹œìŠ¤í…œ - ë§¤ì¶œ ë¶„ì„</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="layout">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>ì˜ì—…ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            </div>
            <nav class="sidebar-nav">
                <a href="../index.html" class="nav-item">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>ëŒ€ì‹œë³´ë“œ</span>
                </a>
                <a href="employees.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬</span>
                </a>
                <a href="employees-type1.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬ (ìœ í˜•1)</span>
                </a>
                <a href="employees-type2.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬ (ìœ í˜•2)</span>
                </a>
                <a href="customers.html" class="nav-item">
                    <span class="nav-icon">ğŸ¢</span>
                    <span>ê³ ê° ê´€ë¦¬</span>
                </a>
                <a href="products.html" class="nav-item">
                    <span class="nav-icon">ğŸ“¦</span>
                    <span>ì œí’ˆ ê´€ë¦¬</span>
                </a>
                <a href="common-code.html" class="nav-item">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>ê³µí†µì½”ë“œ ê´€ë¦¬</span>
                </a>
                <a href="bi-sales.html" class="nav-item active">
                    <span class="nav-icon">ğŸ“ˆ</span>
                    <span>ë§¤ì¶œ ë¶„ì„</span>
                </a>
                <a href="bi-performance.html" class="nav-item">
                    <span class="nav-icon">ğŸ¯</span>
                    <span>ì‹¤ì  ë¶„ì„</span>
                </a>
            </nav>
        </aside>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <header class="header">
                <h2>ë§¤ì¶œ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h2>
                <div class="header-actions">
                    <label for="yearMonthFilter" style="margin-right: 8px;">ì—°ì›”</label>
                    <input type="text" id="yearMonthFilter" class="form-control" style="width: 150px;" value="2024-01" placeholder="YYYY-MM" pattern="\d{4}-\d{2}">
                    <button class="btn btn-primary" onclick="updateDashboard()">ì¡°íšŒ</button>
                    <button class="btn btn-outline">PDF ë‚´ë³´ë‚´ê¸°</button>
                    <button class="btn btn-outline">Excel ë‹¤ìš´ë¡œë“œ</button>
                </div>
            </header>

            <div class="content">
                <!-- KPI ì¹´ë“œ ê·¸ë¦¬ë“œ -->
                <div class="bi-grid mb-3">
                    <!-- KPI ì¹´ë“œë“¤ -->
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon blue">ğŸ’°</div>
                        <div class="kpi-value" id="kpiTotalSales">â‚©0</div>
                        <div class="kpi-label">ì´ ë§¤ì¶œì•¡</div>
                        <div class="kpi-change up">â–² 12.5% ì „ë…„ ëŒ€ë¹„</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon green">ğŸ“¦</div>
                        <div class="kpi-value" id="kpiTotalQty">0</div>
                        <div class="kpi-label">ì´ íŒë§¤ìˆ˜ëŸ‰</div>
                        <div class="kpi-change up">â–² 8.3% ì „ë…„ ëŒ€ë¹„</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon orange">ğŸ§¾</div>
                        <div class="kpi-value" id="kpiAvgOrder">â‚©0</div>
                        <div class="kpi-label">í‰ê·  ì£¼ë¬¸ê¸ˆì•¡</div>
                        <div class="kpi-change down">â–¼ 2.1% ì „ë…„ ëŒ€ë¹„</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon purple">ğŸ†</div>
                        <div class="kpi-value" id="kpiAchievement">0%</div>
                        <div class="kpi-label">ëª©í‘œ ë‹¬ì„±ë¥ </div>
                        <div class="kpi-change up">â–² 5.2% ì „ë…„ ëŒ€ë¹„</div>
                    </div>
                </div>

                <div class="bi-grid mb-3">
                    <!-- ì›”ë³„ ë§¤ì¶œ ì¶”ì´ -->
                    <div class="bi-card col-8">
                        <div class="bi-header">
                            <h4>ì›”ë³„ ë§¤ì¶œ ì¶”ì´</h4>
                            <div class="tab-filter">
                                <button class="active">ë§¤ì¶œì•¡</button>
                                <button>íŒë§¤ìˆ˜ëŸ‰</button>
                                <button>ì£¼ë¬¸ê±´ìˆ˜</button>
                            </div>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder">
                                <div class="chart-icon">ğŸ“Š</div>
                                <div>ì›”ë³„ ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸ ì˜ì—­</div>
                                <div style="font-size: 0.75rem; margin-top: 8px;">ì‹¤ì œ êµ¬í˜„ ì‹œ Chart.js ë˜ëŠ” ApexCharts ì‚¬ìš©</div>
                            </div>
                            <!-- ê°„ë‹¨í•œ í…Œì´ë¸” í˜•íƒœ ë°ì´í„° í‘œì‹œ -->
                            <table class="bi-table mt-2">
                                <thead>
                                    <tr>
                                        <th>ì›”</th>
                                        <th class="number">ë§¤ì¶œì•¡</th>
                                        <th class="number">ëª©í‘œ</th>
                                        <th class="number">ë‹¬ì„±ë¥ </th>
                                        <th>ì¶”ì´</th>
                                    </tr>
                                </thead>
                                <tbody id="monthlyTrendBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ -->
                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ ë¹„ì¤‘</h4>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder" style="height: 180px;">
                                <div class="chart-icon">ğŸ¥§</div>
                                <div>ë„ë„› ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                            <ul class="ranking-list" id="categoryRankingList">
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="bi-grid mb-3">
                    <!-- ê³ ê°ë³„ ë§¤ì¶œ TOP 10 -->
                    <div class="bi-card col-6">
                        <div class="bi-header">
                            <h4>ê³ ê°ë³„ ë§¤ì¶œ TOP 10</h4>
                            <button class="btn btn-sm btn-outline" onclick="showDetail('customer')">ìƒì„¸ë³´ê¸°</button>
                        </div>
                        <div class="bi-body" style="padding: 0;">
                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">ìˆœìœ„</th>
                                        <th>ê³ ê°ëª…</th>
                                        <th>ê³ ê°ìœ í˜•</th>
                                        <th class="number">ë§¤ì¶œì•¡</th>
                                        <th class="number">ë¹„ì¤‘</th>
                                    </tr>
                                </thead>
                                <tbody id="customerRankingBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ì œí’ˆë³„ ë§¤ì¶œ TOP 10 -->
                    <div class="bi-card col-6">
                        <div class="bi-header">
                            <h4>ì œí’ˆë³„ ë§¤ì¶œ TOP 10</h4>
                            <button class="btn btn-sm btn-outline" onclick="showDetail('product')">ìƒì„¸ë³´ê¸°</button>
                        </div>
                        <div class="bi-body" style="padding: 0;">
                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">ìˆœìœ„</th>
                                        <th>ì œí’ˆëª…</th>
                                        <th>ì¹´í…Œê³ ë¦¬</th>
                                        <th class="number">íŒë§¤ìˆ˜ëŸ‰</th>
                                        <th class="number">ë§¤ì¶œì•¡</th>
                                    </tr>
                                </thead>
                                <tbody id="productRankingBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="bi-grid">
                    <!-- ì§€ì—­ë³„ ë§¤ì¶œ ë¶„í¬ -->
                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì§€ì—­ë³„ ë§¤ì¶œ ë¶„í¬</h4>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder" style="height: 200px;">
                                <div class="chart-icon">ğŸ¥§</div>
                                <div>ë„ë„› ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                            <table class="bi-table mt-2">
                                <thead>
                                    <tr>
                                        <th>ì§€ì—­</th>
                                        <th class="number">ë§¤ì¶œì•¡</th>
                                        <th class="number">ë¹„ì¤‘</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>ì„œìš¸/ê²½ê¸°</td><td class="number">â‚©2,450,000,000</td><td class="number">45.2%</td></tr>
                                    <tr><td>ë¶€ì‚°/ê²½ë‚¨</td><td class="number">â‚©980,000,000</td><td class="number">18.1%</td></tr>
                                    <tr><td>ëŒ€êµ¬/ê²½ë¶</td><td class="number">â‚©720,000,000</td><td class="number">13.3%</td></tr>
                                    <tr><td>ëŒ€ì „/ì¶©ì²­</td><td class="number">â‚©650,000,000</td><td class="number">12.0%</td></tr>
                                    <tr><td>ê¸°íƒ€</td><td class="number">â‚©620,000,000</td><td class="number">11.4%</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ì‹œê°„ëŒ€ë³„ ë§¤ì¶œ -->
                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ìš”ì¼ë³„ ë§¤ì¶œ íŒ¨í„´</h4>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder" style="height: 200px;">
                                <div class="chart-icon">ğŸ“Š</div>
                                <div>ë§‰ëŒ€ ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                            <table class="bi-table mt-2">
                                <thead>
                                    <tr>
                                        <th>ìš”ì¼</th>
                                        <th class="number">ì£¼ë¬¸ê±´ìˆ˜</th>
                                        <th class="number">ë§¤ì¶œì•¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>ì›”ìš”ì¼</td><td class="number">245</td><td class="number">â‚©890,000,000</td></tr>
                                    <tr><td>í™”ìš”ì¼</td><td class="number">312</td><td class="number">â‚©1,120,000,000</td></tr>
                                    <tr><td>ìˆ˜ìš”ì¼</td><td class="number">298</td><td class="number">â‚©1,050,000,000</td></tr>
                                    <tr><td>ëª©ìš”ì¼</td><td class="number">276</td><td class="number">â‚©980,000,000</td></tr>
                                    <tr><td>ê¸ˆìš”ì¼</td><td class="number">334</td><td class="number">â‚©1,280,000,000</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ë§¤ì¶œ ëª©í‘œ ë‹¬ì„± í˜„í™© -->
                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ë¶„ê¸°ë³„ ëª©í‘œ ë‹¬ì„±</h4>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder" style="height: 220px;">
                                <div class="chart-icon">ğŸ¥§</div>
                                <div>íŒŒì´ ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                            <div style="display: flex; justify-content: center; gap: 16px; margin: 12px 0; font-size: 0.8rem; color: var(--text-secondary);">
                                <span><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#8b9dc3;margin-right:4px;"></span>Q1</span>
                                <span><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#b0bec5;margin-right:4px;"></span>Q2</span>
                                <span><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#c5e1a5;margin-right:4px;"></span>Q3</span>
                                <span><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#ffe082;margin-right:4px;"></span>Q4</span>
                            </div>

                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th>ë¶„ê¸°</th>
                                        <th class="number">ëª©í‘œ</th>
                                        <th class="number">ì‹¤ì </th>
                                        <th class="number">ë‹¬ì„±ë¥ </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Q1</td>
                                        <td class="number">â‚©133,282M</td>
                                        <td class="number">â‚©1,001M</td>
                                        <td class="number">0.8%</td>
                                    </tr>
                                    <tr>
                                        <td>Q2</td>
                                        <td class="number">â‚©56,664M</td>
                                        <td class="number">â‚©509M</td>
                                        <td class="number">0.9%</td>
                                    </tr>
                                    <tr>
                                        <td>Q3</td>
                                        <td class="number">â‚©16,645M</td>
                                        <td class="number">â‚©476M</td>
                                        <td class="number">2.9%</td>
                                    </tr>
                                    <tr>
                                        <td>Q4</td>
                                        <td class="number">â‚©19,698M</td>
                                        <td class="number">â‚©624M</td>
                                        <td class="number">3.2%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div class="modal" id="detailModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 id="detailModalTitle">ìƒì„¸ë³´ê¸°</h3>
                <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0; max-height: 500px; overflow: auto;">
                <table class="table" id="detailModalTable">
                    <thead id="detailModalHead"></thead>
                    <tbody id="detailModalBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="../js/mock-data.js"></script>
    <script src="../js/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
        });

        function updateDashboard() {
            renderKPI();
            renderMonthlyTrend();
            renderCategoryRanking();
            renderCustomerRanking();
            renderProductRanking();
        }

        function renderKPI() {
            const totalSales = SALES_PERFORMANCE.reduce((sum, p) => sum + p.SALE_AMT, 0);
            const totalQty = SALES_PERFORMANCE.reduce((sum, p) => sum + p.SALE_QTY, 0);
            const avgOrder = SALES_PERFORMANCE.length > 0 ? totalSales / SALES_PERFORMANCE.length : 0;
            const totalTarget = SALES_PLANS.reduce((sum, p) => sum + p.PLAN_AMT, 0);
            const achievement = totalTarget > 0 ? (totalSales / totalTarget * 100) : 0;

            document.getElementById('kpiTotalSales').textContent = formatCurrency(totalSales);
            document.getElementById('kpiTotalQty').textContent = formatNumber(totalQty) + 'ê°œ';
            document.getElementById('kpiAvgOrder').textContent = formatCurrency(Math.round(avgOrder));
            document.getElementById('kpiAchievement').textContent = formatPercent(achievement);
        }

        function renderMonthlyTrend() {
            const tbody = document.getElementById('monthlyTrendBody');
            tbody.innerHTML = '';

            MONTHLY_SALES.forEach((item, idx) => {
                const rate = item.target > 0 ? (item.sales / item.target * 100) : 0;
                const rateClass = rate >= 100 ? 'positive' : (rate >= 90 ? '' : 'negative');
                const prevSales = idx > 0 ? MONTHLY_SALES[idx - 1].sales : item.sales;
                const trend = item.sales >= prevSales ? 'ğŸ“ˆ' : 'ğŸ“‰';

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.month}</td>
                    <td class="number">${formatCurrency(item.sales)}</td>
                    <td class="number">${formatCurrency(item.target)}</td>
                    <td class="number ${rateClass}">${formatPercent(rate)}</td>
                    <td style="text-align: center;">${trend}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderCategoryRanking() {
            const list = document.getElementById('categoryRankingList');
            list.innerHTML = '';

            const total = CATEGORY_SALES.reduce((sum, c) => sum + c.sales, 0);

            CATEGORY_SALES.slice(0, 5).forEach((item, idx) => {
                const ratio = total > 0 ? (item.sales / total * 100) : 0;
                const rankClass = idx === 0 ? 'top-1' : (idx === 1 ? 'top-2' : (idx === 2 ? 'top-3' : ''));

                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="rank ${rankClass}">${idx + 1}</span>
                    <div class="info">
                        <div class="name">${item.category}</div>
                        <div class="sub">${formatCurrency(item.sales)}</div>
                    </div>
                    <div class="value">${formatPercent(ratio)}</div>
                `;
                list.appendChild(li);
            });
        }

        function renderCustomerRanking() {
            const tbody = document.getElementById('customerRankingBody');
            tbody.innerHTML = '';

            // ê³ ê°ë³„ ë§¤ì¶œ ì§‘ê³„
            const customerSales = {};
            SALES_PERFORMANCE.forEach(p => {
                if (!customerSales[p.CUST_ID]) {
                    customerSales[p.CUST_ID] = 0;
                }
                customerSales[p.CUST_ID] += p.SALE_AMT;
            });

            const total = Object.values(customerSales).reduce((sum, v) => sum + v, 0);
            const sortedCustomers = Object.entries(customerSales)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            sortedCustomers.forEach(([custId, sales], idx) => {
                const cust = CUSTOMERS.find(c => c.CUST_ID === custId);
                const ratio = total > 0 ? (sales / total * 100) : 0;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${idx + 1}</strong></td>
                    <td>${cust ? cust.CUST_NM : custId}</td>
                    <td>${cust ? getCodeName('CUST_TYPE', cust.CUST_TYPE) : '-'}</td>
                    <td class="number"><strong>${formatCurrency(sales)}</strong></td>
                    <td class="number">${formatPercent(ratio)}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderProductRanking() {
            const tbody = document.getElementById('productRankingBody');
            tbody.innerHTML = '';

            // ì œí’ˆë³„ ë§¤ì¶œ ì§‘ê³„
            const productSales = {};
            const productQty = {};
            SALES_PERFORMANCE.forEach(p => {
                if (!productSales[p.PROD_ID]) {
                    productSales[p.PROD_ID] = 0;
                    productQty[p.PROD_ID] = 0;
                }
                productSales[p.PROD_ID] += p.SALE_AMT;
                productQty[p.PROD_ID] += p.SALE_QTY;
            });

            const sortedProducts = Object.entries(productSales)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            sortedProducts.forEach(([prodId, sales], idx) => {
                const prod = PRODUCTS.find(p => p.PROD_ID === prodId);
                const qty = productQty[prodId] || 0;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${idx + 1}</strong></td>
                    <td>${prod ? prod.PROD_NM : prodId}</td>
                    <td>${prod ? getCodeName('PROD_CATEGORY', prod.CATEGORY) : '-'}</td>
                    <td class="number">${formatNumber(qty)}</td>
                    <td class="number"><strong>${formatCurrency(sales)}</strong></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function showDetail(type) {
            const thead = document.getElementById('detailModalHead');
            const tbody = document.getElementById('detailModalBody');
            thead.innerHTML = '';
            tbody.innerHTML = '';

            if (type === 'customer') {
                document.getElementById('detailModalTitle').textContent = 'ê³ ê°ë³„ ë§¤ì¶œ ìƒì„¸';
                thead.innerHTML = '<tr><th style="width:50px;">ìˆœìœ„</th><th>ê³ ê°ëª…</th><th>ê³ ê°ìœ í˜•</th><th class="number">ë§¤ì¶œì•¡</th><th class="number">ë¹„ì¤‘</th></tr>';

                const customerSales = {};
                SALES_PERFORMANCE.forEach(p => {
                    if (!customerSales[p.CUST_ID]) customerSales[p.CUST_ID] = 0;
                    customerSales[p.CUST_ID] += p.SALE_AMT;
                });
                const total = Object.values(customerSales).reduce((sum, v) => sum + v, 0);
                const sorted = Object.entries(customerSales).sort((a, b) => b[1] - a[1]);

                sorted.forEach(([custId, sales], idx) => {
                    const cust = CUSTOMERS.find(c => c.CUST_ID === custId);
                    const ratio = total > 0 ? (sales / total * 100) : 0;
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${idx + 1}</strong></td>
                        <td>${cust ? cust.CUST_NM : custId}</td>
                        <td>${cust ? getCodeName('CUST_TYPE', cust.CUST_TYPE) : '-'}</td>
                        <td class="number"><strong>${formatCurrency(sales)}</strong></td>
                        <td class="number">${formatPercent(ratio)}</td>
                    `;
                    tbody.appendChild(tr);
                });
            } else if (type === 'product') {
                document.getElementById('detailModalTitle').textContent = 'ì œí’ˆë³„ ë§¤ì¶œ ìƒì„¸';
                thead.innerHTML = '<tr><th style="width:50px;">ìˆœìœ„</th><th>ì œí’ˆëª…</th><th>ì¹´í…Œê³ ë¦¬</th><th class="number">íŒë§¤ìˆ˜ëŸ‰</th><th class="number">ë§¤ì¶œì•¡</th></tr>';

                const productSales = {};
                const productQty = {};
                SALES_PERFORMANCE.forEach(p => {
                    if (!productSales[p.PROD_ID]) {
                        productSales[p.PROD_ID] = 0;
                        productQty[p.PROD_ID] = 0;
                    }
                    productSales[p.PROD_ID] += p.SALE_AMT;
                    productQty[p.PROD_ID] += p.SALE_QTY;
                });
                const sorted = Object.entries(productSales).sort((a, b) => b[1] - a[1]);

                sorted.forEach(([prodId, sales], idx) => {
                    const prod = PRODUCTS.find(p => p.PROD_ID === prodId);
                    const qty = productQty[prodId] || 0;
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${idx + 1}</strong></td>
                        <td>${prod ? prod.PROD_NM : prodId}</td>
                        <td>${prod ? getCodeName('PROD_CATEGORY', prod.CATEGORY) : '-'}</td>
                        <td class="number">${formatNumber(qty)}</td>
                        <td class="number"><strong>${formatCurrency(sales)}</strong></td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            openModal('detailModal');
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì—…ê´€ë¦¬ ì‹œìŠ¤í…œ - ì‹¤ì  ë¶„ì„</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="layout">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>ì˜ì—…ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            </div>
            <nav class="sidebar-nav">
                <a href="../index.html" class="nav-item">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>ëŒ€ì‹œë³´ë“œ</span>
                </a>
                <a href="employees.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬</span>
                </a>
                <a href="employees-type1.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬ (ìœ í˜•1)</span>
                </a>
                <a href="employees-type2.html" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬ (ìœ í˜•2)</span>
                </a>
                <a href="customers.html" class="nav-item">
                    <span class="nav-icon">ğŸ¢</span>
                    <span>ê³ ê° ê´€ë¦¬</span>
                </a>
                <a href="products.html" class="nav-item">
                    <span class="nav-icon">ğŸ“¦</span>
                    <span>ì œí’ˆ ê´€ë¦¬</span>
                </a>
                <a href="common-code.html" class="nav-item">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>ê³µí†µì½”ë“œ ê´€ë¦¬</span>
                </a>
                <a href="bi-sales.html" class="nav-item">
                    <span class="nav-icon">ğŸ“ˆ</span>
                    <span>ë§¤ì¶œ ë¶„ì„</span>
                </a>
                <a href="bi-performance.html" class="nav-item active">
                    <span class="nav-icon">ğŸ¯</span>
                    <span>ì‹¤ì  ë¶„ì„</span>
                </a>
            </nav>
        </aside>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <header class="header">
                <h2>ì‹¤ì  ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h2>
                <div class="header-actions">
                    <label for="yearFilter" style="margin-right: 8px;">ì—°ë„</label>
                    <select id="yearFilter" class="form-control" style="width: 150px;">
                        <option value="2024" selected>2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                    </select>
                    <button class="btn btn-primary" onclick="updateDashboard()">ì¡°íšŒ</button>
                </div>
            </header>

            <div class="content">
                <!-- KPI ìš”ì•½ ì¹´ë“œ (4ê°œ) -->
                <div class="bi-grid mb-3">
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon blue">ğŸ‘¥</div>
                        <div class="kpi-value" id="kpiTeamCount">11</div>
                        <div class="kpi-label">ì˜ì—… íŒ€ ìˆ˜</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon green">ğŸ†</div>
                        <div class="kpi-value" id="kpiTopTeam">ì˜ì—…1íŒ€</div>
                        <div class="kpi-label">ìµœê³  ì‹¤ì  íŒ€</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon orange">â­</div>
                        <div class="kpi-value" id="kpiTopEmployee">ë°•íŒ€ì¥</div>
                        <div class="kpi-label">ì´ë‹¬ì˜ MVP</div>
                    </div>
                    <div class="bi-card col-3 kpi-card">
                        <div class="kpi-icon red">ğŸ“Š</div>
                        <div class="kpi-value" id="kpiAvgAchieve">61.4%</div>
                        <div class="kpi-label">í‰ê·  ë‹¬ì„±ë¥ </div>
                    </div>
                </div>

                <!-- íŒ€ë³„ ì‹¤ì  ë¹„êµ + ì§ì›ë³„ ì‹¤ì  ìˆœìœ„ -->
                <div class="bi-grid mb-3">
                    <div class="bi-card col-6">
                        <div class="bi-header">
                            <h4>íŒ€ë³„ ì‹¤ì  ë¹„êµ</h4>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder" style="height: 200px;">
                                <div class="chart-icon">ğŸ“Š</div>
                                <div>ë§‰ëŒ€ ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                            <table class="bi-table mt-2">
                                <thead>
                                    <tr>
                                        <th>íŒ€ëª…</th>
                                        <th>ê¸°ê°„ êµ¬ë¶„</th>
                                        <th class="number">ëª©í‘œ</th>
                                        <th class="number">ì‹¤ì </th>
                                        <th class="number">ë‹¬ì„±ë¥ </th>
                                    </tr>
                                </thead>
                                <tbody id="teamCompareBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bi-card col-6">
                        <div class="bi-header">
                            <h4>ì§ì›ë³„ ì‹¤ì  ìˆœìœ„ TOP 10</h4>
                        </div>
                        <div class="bi-body" style="padding: 0;">
                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">ìˆœìœ„</th>
                                        <th>ì§ì›ëª…</th>
                                        <th>ë¶€ì„œ/íŒ€</th>
                                        <th class="number">ì‹¤ì </th>
                                        <th class="number">ë‹¬ì„±ë¥ </th>
                                    </tr>
                                </thead>
                                <tbody id="employeeRankBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ëª©í‘œ ëŒ€ë¹„ ì‹¤ì  ì¶”ì´ + ì‹¤ì  ë‹¬ì„±ë¥  ë¶„í¬ -->
                <div class="bi-grid mb-3">
                    <div class="bi-card col-8">
                        <div class="bi-header">
                            <h4>ëª©í‘œ ëŒ€ë¹„ ì‹¤ì  ì¶”ì´</h4>
                            <div class="tab-filter">
                                <button class="active" onclick="filterByDept('')">ì „ì²´</button>
                                <button onclick="filterByDept('DEPT011')">ì˜ì—…1íŒ€</button>
                                <button onclick="filterByDept('DEPT012')">ì˜ì—…2íŒ€</button>
                            </div>
                        </div>
                        <div class="bi-body">
                            <div class="chart-placeholder">
                                <div class="chart-icon">ğŸ“ˆ</div>
                                <div>ëª©í‘œ/ì‹¤ì  ë¼ì¸ ì°¨íŠ¸ ì˜ì—­</div>
                            </div>
                        </div>
                        <div class="bi-footer">
                            <span>ğŸ”µ ëª©í‘œ</span> &nbsp;|&nbsp; <span>ğŸŸ¢ ì‹¤ì </span> &nbsp;|&nbsp;
                            <span class="positive">â–  ì´ˆê³¼ë‹¬ì„±</span> &nbsp;|&nbsp; <span class="negative">â–  ë¯¸ë‹¬ì„±</span>
                        </div>
                    </div>

                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì‹¤ì  ë‹¬ì„±ë¥  ë¶„í¬</h4>
                        </div>
                        <div class="bi-body">
                            <!-- ë°” ì°¨íŠ¸ -->
                            <div style="padding: 8px 0;">
                                <div style="position: relative; height: 150px; display: flex; align-items: flex-end; justify-content: space-around; padding: 0 24px 0 4px; border-bottom: 1px solid #e2e8f0;">
                                    <div style="position: absolute; top: 0; left: 0; right: 0; border-top: 1px dashed #e2e8f0; font-size: 0.65rem; color: #94a3b8; padding-left: 2px;">100%</div>
                                    <div style="position: absolute; top: 50%; left: 0; right: 0; border-top: 1px dashed #e2e8f0; font-size: 0.65rem; color: #94a3b8; padding-left: 2px;">50%</div>
                                    <div style="position: absolute; bottom: 0; left: 0; font-size: 0.65rem; color: #94a3b8;">0%</div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 68%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 65%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 35%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 63%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 62%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 78%;"></div>
                                    <div style="width: 12%; background: #7c93c3; border-radius: 3px 3px 0 0; height: 72%;"></div>
                                </div>
                                <div style="display: flex; justify-content: space-around; padding: 6px 4px 0; font-size: 0.75rem; color: var(--text-secondary);">
                                    <span style="width: 12%; text-align: center;">ì„œëŒ€ë¦¬</span>
                                    <span style="width: 12%; text-align: center;">ìœ¤ì‚¬ì›</span>
                                    <span style="width: 12%; text-align: center;">ìµœëŒ€ë¦¬</span>
                                    <span style="width: 12%; text-align: center;">ì˜¤ê³¼ì¥</span>
                                    <span style="width: 12%; text-align: center;">ê°•íŒ€ì¥</span>
                                    <span style="width: 12%; text-align: center;">ì •ì‚¬ì›</span>
                                    <span style="width: 12%; text-align: center;">ë°•íŒ€ì¥</span>
                                </div>
                            </div>

                            <!-- ë‹¬ì„±ë¥  ë¶„ë¥˜ -->
                            <div style="margin-top: 16px; display: flex; flex-direction: column;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 4px; border-bottom: 1px solid #e2e8f0;">
                                    <span style="font-size: 0.85rem; color: var(--text-primary);">120% ì´ìƒ (ì´ˆê³¼ë‹¬ì„±)</span>
                                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--primary-color);" id="rateVal1">0ëª…</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 4px; border-bottom: 1px solid #e2e8f0;">
                                    <span style="font-size: 0.85rem; color: var(--text-primary);">100~120% (ëª©í‘œë‹¬ì„±)</span>
                                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--primary-color);" id="rateVal2">0ëª…</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 4px; border-bottom: 1px solid #e2e8f0;">
                                    <span style="font-size: 0.85rem; color: var(--text-primary);">80 ~ 100% (ê·¼ì ‘)</span>
                                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--primary-color);" id="rateVal3">0ëª…</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 4px;">
                                    <span style="font-size: 0.85rem; color: var(--text-primary);">80% ë¯¸ë§Œ (ë¯¸ë‹¬)</span>
                                    <span style="font-size: 0.9rem; font-weight: 600; color: #ef4444;" id="rateVal4">7ëª…</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì‹ ê·œ ê³ ê° íšë“ + ì˜ì—… í™œë™ ì§€í‘œ + ì‹¤ì  ì•Œë¦¼ -->
                <div class="bi-grid">
                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì‹ ê·œ ê³ ê° íšë“</h4>
                        </div>
                        <div class="bi-body">
                            <div style="text-align: center; padding: 16px 0; margin-bottom: 12px;">
                                <div style="font-size: 2rem; font-weight: 700;" id="custTotal">24</div>
                                <div style="font-size: 0.875rem; color: var(--text-secondary);">ì˜¬í•´ ì‹ ê·œ ê³ ê°</div>
                                <div id="custChange" style="font-size: 0.8rem; margin-top: 4px; color: var(--text-muted);">â€“ ì „ë…„ ëŒ€ë¹„</div>
                            </div>

                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th>ì§ì›</th>
                                        <th class="number">ì‹ ê·œê³ ê°</th>
                                        <th class="number">ê³„ì•½ì•¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ê¹€ì˜ì—…</td>
                                        <td class="number">5</td>
                                        <td class="number">â‚©450M</td>
                                    </tr>
                                    <tr>
                                        <td>ì´íŒë§¤</td>
                                        <td class="number">4</td>
                                        <td class="number">â‚©380M</td>
                                    </tr>
                                    <tr>
                                        <td>ë°•ê±°ë˜</td>
                                        <td class="number">4</td>
                                        <td class="number">â‚©320M</td>
                                    </tr>
                                    <tr>
                                        <td>ìµœì„±ê³¼</td>
                                        <td class="number">3</td>
                                        <td class="number">â‚©280M</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì˜ì—… í™œë™ ì§€í‘œ</h4>
                        </div>
                        <div class="bi-body">
                            <table class="bi-table">
                                <thead>
                                    <tr>
                                        <th>ì§€í‘œ</th>
                                        <th class="number">ì˜¬í•´</th>
                                        <th class="number">ì „ë…„</th>
                                        <th class="number">ì¦ê°</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ê¸°íƒ€</td>
                                        <td class="number">37</td>
                                        <td class="number">0</td>
                                        <td class="number positive">37</td>
                                    </tr>
                                    <tr>
                                        <td>ë°œì£¼</td>
                                        <td class="number">3</td>
                                        <td class="number">0</td>
                                        <td class="number positive">3</td>
                                    </tr>
                                    <tr>
                                        <td>ë‚©í’ˆ</td>
                                        <td class="number">9</td>
                                        <td class="number">0</td>
                                        <td class="number positive">9</td>
                                    </tr>
                                    <tr>
                                        <td>êµ¬ë§¤</td>
                                        <td class="number">4</td>
                                        <td class="number">0</td>
                                        <td class="number positive">4</td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="mt-2" style="padding: 16px;">
                                <div class="flex-between mb-1">
                                    <span style="font-weight: 600;">ê³„ì•½ ì „í™˜ìœ¨</span>
                                    <span style="font-weight: 700; color: var(--primary-color);">98.1%</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-fill" style="width: 98.1%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bi-card col-4">
                        <div class="bi-header">
                            <h4>ì‹¤ì  ì•Œë¦¼</h4>
                        </div>
                        <div class="bi-body" style="padding: 0;">
                            <div style="max-height: 350px; overflow-y: auto;">
                                <div class="list-item" style="padding: 12px 16px; border-left: 3px solid var(--success-color);">
                                    <div class="list-item-content">
                                        <div class="list-item-title">ğŸ† ì˜¬í•´ MVP</div>
                                        <div class="list-item-subtitle">ë°•íŒ€ì¥ë‹˜ - ì—°ê°„ 1ìœ„</div>
                                    </div>
                                    <div class="list-item-date">10ë¶„ ì „</div>
                                </div>
                                <div class="list-item" style="padding: 12px 16px; border-left: 3px solid var(--warning-color);">
                                    <div class="list-item-content">
                                        <div class="list-item-title">âš ï¸ ëª©í‘œ ë¯¸ë‹¬ ê²½ê³ </div>
                                        <div class="list-item-subtitle">ì˜ì—…3íŒ€ ë‹¬ì„±ë¥  75%</div>
                                    </div>
                                    <div class="list-item-date">2ì‹œê°„ ì „</div>
                                </div>
                                <div class="list-item" style="padding: 12px 16px; border-left: 3px solid var(--primary-color);">
                                    <div class="list-item-content">
                                        <div class="list-item-title">ğŸ“ ì‹ ê·œ ê³„ì•½ ì²´ê²°</div>
                                        <div class="list-item-subtitle">ABCê¸°ì—… - â‚©150,000,000</div>
                                    </div>
                                    <div class="list-item-date">5ì‹œê°„ ì „</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/mock-data.js"></script>
    <script src="../js/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initPage();
        });

        function initPage() {
            updateDashboard();
        }

        function updateDashboard() {
            renderKPI();
            renderTeamCompare();
            renderEmployeeRank();
        }

        function renderKPI() {
            // íŒ€ ìˆ˜ (ì˜ì—…íŒ€ë§Œ)
            var salesTeams = DEPARTMENTS.filter(function(d) { return d.DEPT_NM.indexOf('ì˜ì—…') !== -1; });
            document.getElementById('kpiTeamCount').textContent = salesTeams.length + 'ê°œ';

            // ìµœê³  ì‹¤ì  íŒ€
            if (TEAM_PERFORMANCE.length > 0) {
                var topTeam = TEAM_PERFORMANCE.reduce(function(max, t) { return t.sales > max.sales ? t : max; });
                document.getElementById('kpiTopTeam').textContent = topTeam.team;
            }

            // MVP
            if (EMPLOYEE_PERFORMANCE.length > 0) {
                document.getElementById('kpiTopEmployee').textContent = EMPLOYEE_PERFORMANCE[0].name;
            }

            // í‰ê·  ë‹¬ì„±ë¥ 
            if (TEAM_PERFORMANCE.length > 0) {
                var avgRate = TEAM_PERFORMANCE.reduce(function(sum, t) {
                    return sum + (t.target > 0 ? t.sales / t.target * 100 : 0);
                }, 0) / TEAM_PERFORMANCE.length;
                document.getElementById('kpiAvgAchieve').textContent = formatPercent(avgRate);
            }
        }

        function renderTeamCompare() {
            var tbody = document.getElementById('teamCompareBody');
            tbody.innerHTML = '';

            var year = document.getElementById('yearFilter').value;

            TEAM_PERFORMANCE.forEach(function(team) {
                var rate = team.target > 0 ? (team.sales / team.target * 100) : 0;
                var rateClass = rate >= 100 ? 'positive' : (rate >= 80 ? '' : 'negative');

                var tr = document.createElement('tr');
                tr.innerHTML =
                    '<td><strong>' + team.team + '</strong></td>' +
                    '<td>' + year + '</td>' +
                    '<td class="number">' + formatCurrency(team.target) + '</td>' +
                    '<td class="number">' + formatCurrency(team.sales) + '</td>' +
                    '<td class="number ' + rateClass + '"><strong>' + formatPercent(rate) + '</strong></td>';
                tbody.appendChild(tr);
            });
        }

        function renderEmployeeRank() {
            var tbody = document.getElementById('employeeRankBody');
            tbody.innerHTML = '';

            EMPLOYEE_PERFORMANCE.slice(0, 10).forEach(function(emp, idx) {
                var rate = Math.floor(Math.random() * 40) + 80;

                var tr = document.createElement('tr');
                tr.innerHTML =
                    '<td><strong>' + (idx + 1) + '</strong></td>' +
                    '<td><strong>' + emp.name + '</strong></td>' +
                    '<td>' + emp.team + '</td>' +
                    '<td class="number"><strong>' + formatCurrency(emp.sales) + '</strong></td>' +
                    '<td class="number ' + (rate >= 100 ? 'positive' : '') + '">' + rate + '%</td>';
                tbody.appendChild(tr);
            });
        }

        function filterByDept(deptCode) {
            // íƒ­ í™œì„±í™” í† ê¸€
            var buttons = document.querySelectorAll('.tab-filter button');
            buttons.forEach(function(btn) { btn.classList.remove('active'); });
            event.target.classList.add('active');

            // ë¶€ì„œ í•„í„° ì ìš© (ë°ì´í„° ì—°ë™ ì‹œ ì‚¬ìš©)
            console.log('Filter by dept:', deptCode);
        }
    </script>
</body>
</html>
